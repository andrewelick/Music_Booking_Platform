<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, intial-scale=1.0, maximum-scale=1, user-scalable=0">
    <title>Bluff Tour</title>

    <link href="https://fonts.googleapis.com/css?family=Montserrat|Quicksand" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="static/styles.css" />
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/places.js@1.16.4"></script>

    <!--- Google location search --->
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBC4QsshH52K2yK6agjv2dXIjoYxE-6o5M&amp;libraries=places"></script>


    <style type='text/css'>
      body {
        margin:0;
        padding:0;
        box-sizing: border-box;
        height: 100%;
        width: 100%;
      }

        .mobilegridrow-2 {
            overflow: hidden;
            box-sizing: border-box;
            width: 100%;
            padding: 0;
            padding:10px;
            margin-bottom: 20px;
            text-align: center;
        }

        #profile_container {
            box-sizing: border-box;
            width: 100%;
            padding: 10px;
            background-color: #FFFFFF;
            color: #383838;
            border-top-right-radius: 5px;
            border-top-left-radius: 5px;
            float: left;
            overflow: hidden;
        }

        .profile_picture_personal {
            height: 35px;
            margin: 5px;
            border-radius: 100%;
            border: 2px solid;
            border-color: #FFFFFF;
            float: left;
        }

        .quick_stats_container {
            box-sizing: border-box;
            margin-top: 3px;
            text-align: left;
            float: center;
            font-size: 12px;
        }

        .profile_quick_link {
            display: inline-block;
            margin-bottom: 4px;
            margin-right: 4px;
            color: #383838;
        }

        .profile_quick_link:hover {
            text-decoration: underline;
        }

        #user_container {
            margin: auto;
            margin-bottom: 15px;
            width: 100%;
            padding-bottom: 10px;
            border-radius: 5px;
            background-color: #FFFFFF;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
            float: right;
        }

        #ending_shows_container {
            margin-top: 20px;
        }

        .singlelisting {
            padding: 10px;
            border-top: 1px solid;
            border-color: #d2d2d2;
            font-size: 12px;
            overflow: hidden;
        }

        .listing_details {
            padding-bottom: 10px;
        }

        .listing_header_title {
            font-size: 16px;
        }

        .detail_title {
            vertical-align: middle;
        }

        .icon {
            padding-right: 3px;
            height: 13px;
            vertical-align: middle;
        }

        .listing_stats_option {
            margin-top:-5px;
            padding:5px;
            border-radius: 5px;
            font-size:10px;
            background-color:#596B83;
            color:#FFFFFF;
        }

        .more_details_link {
            width: 100;
            padding: 10px;
            float: right;
            border-radius: 5px;
            font-size: 12px;
        }

        .more_details_link:hover {
            text-decoration: none;
            background-color: #efefef;
        }

        .showcase_container {
            box-sizing: border-box;
            width: 100%;
            padding: 10px;
            border-bottom: 1px solid;
            border-color: #d2d2d2;
            font-size: 14px;
            text-align: left;
            overflow: hidden;
        }

        .venue_showcase_picture {
            width: 50px;
            margin-right: 5px;
            border-radius: 100%;
            float: left;
        }

        .venue_showcase_busi_type {
            padding-left: 5px;
            font-size: 12px;
        }

        .showcase_bio {
            font-size: 12px;
        }

        .listingbutton {
            box-sizing: border-box;
            width: 90%;
            padding:5px;
            padding-top:10px;
            padding-bottom:10px;
            font-size: 14px;
            display: inline-block;
            border-radius: 5px;
            background-color:#328CC1;
            color:#FFFFFF;
            -webkit-transition: background-color 200ms linear;
            -ms-transition: background-color 200ms linear;
            transition: background-color 200ms linear;
            box-shadow: 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0,0,0,.12);
        }

        .listingbutton:hover {
            cursor: pointer;
            -webkit-transition: background-color 200ms linear;
            -ms-transition: background-color 200ms linear;
            transition: background-color 200ms linear;
        }

        .show_label {
            font-size: 14px;
            position: relative;
            left: 25px;
        }

        #artist_showcase {
            width: 100%;
            border-radius: 5px;
            background-color: #FFFFFF;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
            float: right;
        }

        .form-icon {
            height: 19px;
            padding-right: 5px;
            padding-top: 10px;
            padding-bottom: 10px;
        }

        input, select, textarea {
            box-sizing: border-box;
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            margin-bottom: 5px;
            border: 0;
            border-bottom: 2px solid;
            border-top-right-radius: 5px;
            border-top-left-radius: 5px;
            border-bottom-left-radius: 0px;
            border-bottom-right-radius: 0px;
            border-color: #7992b9;
            color: #FFFFFF;
            background-color: #465f86;
            outline: none;
            font-size: 15px;
            font-family: inherit;
            -webkit-transition: box-shadow 150ms ease;
            transition: 350ms ease;
            -webkit-appearance:none;
        }

        textarea {
            padding-left: 8px;
            border-top-left-radius: 5px;
            resize: none;
        }

        input[type='text']:focus, select:focus, textarea:focus {
            border-color: #cdd6e5;
        }

        button, input[type="submit"] {
            margin-top: 10px;
            padding: 10px;
            padding-left: 20px;
            padding-right: 20px;
            border-radius: 5px;
            border: 0;
            font-size: 13px;
            font-weight: bold;
            background-color: #328CC1;
            color: #FFFFFF;
            float: right;
            display: inline-block;
            outline: none;
            box-shadow: 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0,0,0,.12);
        }

        button:hover, input[type='submit']:hover {
            background-color: #3494cb;
            cursor: pointer;
        }

        .invalidButton {
            background-color: #a6a6a6;
        }

        .invalidButton:hover {
            background-color: #a6a6a6;
        }

        .form-message {
            font-size: 12px;
            padding-left: 25px;
            color: #d2d2d2;
        }

        ::placeholder { /* Chrome, Firefox, Opera, Safari 10.1+ */
            color: #d2d2d2;
            opacity: 1; /* Firefox */
        }

        :-ms-input-placeholder { /* Internet Explorer 10-11 */
            color: #d2d2d2;
        }

        ::-ms-input-placeholder { /* Microsoft Edge */
            color: #d2d2d2;
        }

        #postshow {
            display: none;
            box-sizing: border-box;
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            padding: 15px;
            padding-left: 10px;
            z-index: 99;
            text-align: left;
            box-shadow: 0 0px 15px 0 #111111;
            color: #FFFFFF;
            background: #232f42;
            transition: .5s;
        }

        #new_show_container {
            display: none;
        }

        .add_payments_link {
            display: inline-block;
            padding: 10px;
            width: 150px;
            border-radius: 5px;
            border: 0;
            font-size: 14px;
            background-color: #328CC1;
            color: #FFFFFF;
            display: none;
        }

        .post_message {
            font-size: 14px;
            display: none;
        }

        #blackbackground {
            display: none;
            position: fixed;
            top: 0px;
            left: 0px;
            z-index:10;
            height:100%;
            width: 100%;
            background-color:#000000;
            opacity:.7
        }

        #error_message {
            color: red;
        }

        .ui-datepicker-header {
            background-color: #328CC1;
            color: #ffffff;
            font-family: inherit;
        }

        .loading_gif {
            height: 50px;
        }

        .empty_box_text {
            padding: 20px;
        }

        .invalidForm {
            border-color: #d22d2d;
        }

        /* Ripple effect */
        .ripple {
            background-position: center;
            transition: background 0.8s;
        }
        .ripple:hover {
            background: #47a7f5 radial-gradient(circle, transparent 1%, #47a7f5 1%) center/15000%;
        }
        .ripple:active {
            background-color: #6eb9f7;
            background-size: 100%;
            transition: background 0s;
        }

        .prev-button {
            padding-left: 15px;
            padding-right: 15px;
            background-color: #232f42;
            color: #FFFFFF;
            border-color: #465f86;
            box-shadow: 0px 0px 0px 0px;
        }

        .prev-button:hover {
            background-color: #354764;
        }

        .show_genre_option {
            border: 2px solid;
            padding: 7px;
            margin: 3px;
            margin-right: 5px;
            margin-left: 0;
            border-radius: 5px;
            border-color: #465f86;
            font-size: 13px;
        }

        .show_genre_option:hover {
            background-color: #465f86;
            cursor: pointer;
        }

        .show_genre_option_active {
            border-color: #6eb9f7;
            background-color: #6eb9f7;
        }

        .show_genre_option_active:hover {
            background-color: #6eb9f7
        }

        /* Google classes */
        .pac-item {
            padding: 5px;
        }

        .banner-header {
            padding-bottom: 10px;
        }

        .bannerIcon {
            height: 40px;
            vertical-align: middle;
        }


        /* If screen is bigger than 800px */
        @media screen and (min-width: 800px) {

            .mobilegridrow-2 {
                width: 800px;
                margin: 0 auto;
            }

            #user_container {
                width: 300px;
            }

            #artist_showcase {
                width: 450px;
            }

            #postshow {
                width: 400px;
                border-radius: 5px;
            }

        }

    </style>

    <script type="text/javascript">
    //Datepicker for new show date
    $(function() {
        $("#show_date").datepicker({
            showButtonPanel: true,
            minDate: +14,
        });
    });
    </script>
  </head>
  <body>
    <!--- Header --->
    {% include "header.html" %}

    <!-- Mobile welcome picture with text -->
    <div class='mobilegridrow-2'>

        <!--- Venues showcase card --->
        <div id="user_container">

            <!--- Profile container --->
            <div id="profile_container">
                <!--- Profile picture --->
                <a href="/profile">
                    <img class="profile_picture_personal" src="https://{{AWS_BUCKET_NAME}}.s3.us-east-2.amazonaws.com/static/user_pictures/profile_pictures/{% print uid %}_profile.jpg" />
                </a>

                <!--- Profile name --->
                <div style="padding-top: 10px;font-size: 14px;text-align: left;">
                    <a style="font-weight: bold;" href="/profile">{% print venue_details[1] %}</a>
                </div>

                <!--- Bidding stats -->
                <div class="quick_stats_container">
                    <a href='/messages' class="profile_quick_link">Messages</a>
                    <a href='/payments' class="profile_quick_link">Payments</a>
                    <a href="/yourlistings" class="profile_quick_link">Listings</a>
                </div>

            </div>

            <!--- Post a show button --->
            <div class="listingbutton ripple" id="listingbutton">List a show</div>

            <!--- Ending shows container --->
            <div id="ending_shows_container">
                <div style="padding-bottom: 15px;font-size: 15px;">Shows ending soon</div>

                <div id="ending_shows"></div>

                <!--- Loading gif --->
                <img class="loading_gif" src="static/loading-spinner.gif" />
            </div>

        </div>

        <div id="artist_showcase" style="box-sizing: border-box;float: left;padding: 10px;">
            <div style="padding-bottom:10px;font-size:17px;">Artists around Memphis, TN</div>

            <!--- Venue showcase pictures -->
            {% for artist in featured_artists %}
            <div class="showcase_container" >
                <a href="/profile?uid={% print artist['uid'] %}">
                    <img src="https://{{AWS_BUCKET_NAME}}.s3.us-east-2.amazonaws.com/static/user_pictures/profile_pictures/{% print artist['uid'] %}_profile.jpg" class="venue_showcase_picture fade"/>
                </a>

                <div>
                    <b>{% print artist['artist_name'] %}</b>
                    <font class="venue_showcase_busi_type">- {% print artist['genre'] %}</font>
                </div>

                <!--- Business bio --->
                <div class="showcase_bio">{% print artist['bio'] %}</div>

            </div>
            {% endfor %}

            {% if featured_artists|length == 0 %}
                <div class="empty_box_text">There are no artists in your area. Give them a reason to be!</div>
            {% endif %}

        </div>

    </div>
    <!--- End of Description card --->

    {% include 'footer.html' %}

    <!--- Show posting card -->
    <div id="postshow">

        <div style="border-bottom: 1px solid; border-color: #465f86;padding-bottom: 10px;font-size: 25px;">List a show</div>
        </br>

        <!--- Post show container --->
        <div id="new_show_container">

            <div class="form-holder" id="form-holder-1">
                <!--- Date for show --->
                <span class="show_label">Location</span>
                <br/>
                <div style="display: flex; width: 100%;vertical-align: middle;align-items : center;">
                    <img class="form-icon" src="static/placeholder-white.png" />
                    <input type="text" id="show_location" name="show_location" placeholder="123 Main Street, Memphis TN" autocomplete="off" />
                    <input type="hidden" name="lat" />
                    <input type="hidden" name="long" />
                </div>
                <div class="form-message" id="form-message-location">Required</div>

                <br/>

                <!--- Date for show --->
                <div class="form-wrapper" style="float: left;display: inline;width: 45%; margin-right: 5%;">
                    <span class="show_label">Date</span>
                    <br/>
                    <div style="display: flex; width: 100%;vertical-align: middle;align-items : center;">
                        <img class="form-icon" src="static/calendar.png" />
                        <input type="text" id="show_date" name="show_date" placeholder="12/20/21" autocomplete="off" />
                    </div>
                    <div class="form-message" id="form-message-date">Required</div>
                </div>

                <!--- Time for new show --->
                <div style="float: left;display: inline;width: 50%;margin-bottom: 15px;margin-top: -1px;">
                    <span class="show_label">Time</span>
                    <br/>
                    <div style="display: flex; width: 100%;vertical-align: middle;align-items : center;">
                        <img style="height: 20px" class="form-icon" src="static/time.png" />
                        <select id="show_time" name="show_time">
                            <option val="">Select time</option>
                            <option value="12:00am">12:00am</option>
                            <option value="12:30am">12:30am</option>
                            <option value="1:00am">1:00am</option>
                            <option value="1:30am">1:30am</option>
                            <option value="2:00am">2:00am</option>
                            <option value="2:30am">2:30am</option>
                            <option value="3:00am">3:00am</option>
                            <option value="3:30am">3:30am</option>
                            <option value="4:00am">4:00am</option>
                            <option value="4:30am">4:30am</option>
                            <option value="5:00am">5:00am</option>
                            <option value="5:30am">5:30am</option>
                            <option value="6:00am">6:00am</option>
                            <option value="6:30am">6:30am</option>
                            <option value="7:00am">7:00am</option>
                            <option value="7:30am">7:30am</option>
                            <option value="8:00am">8:00am</option>
                            <option value="8:30am">8:30am</option>
                            <option value="9:00am">9:00am</option>
                            <option value="9:30am">9:30am</option>
                            <option value="10:00am">10:00am</option>
                            <option value="10:30am">10:30am</option>
                            <option value="11:00am">11:00am</option>
                            <option value="11:30am">11:30am</option>
                            <option value="12:00pm">12:00pm</option>
                            <option value="12:30pm">12:30pm</option>
                            <option value="1:00pm">1:00pm</option>
                            <option value="1:30pm">1:30pm</option>
                            <option value="2:00pm">2:00pm</option>
                            <option value="2:30pm">2:30pm</option>
                            <option value="3:00pm">3:00pm</option>
                            <option value="3:30pm">3:30pm</option>
                            <option value="4:00pm">4:00pm</option>
                            <option value="4:30pm">4:30pm</option>
                            <option value="5:00pm">5:00pm</option>
                            <option value="5:30pm">5:30pm</option>
                            <option value="6:00pm">6:00pm</option>
                            <option value="6:30pm">6:30pm</option>
                            <option value="7:00pm">7:00pm</option>
                            <option value="7:30pm">7:30pm</option>
                            <option value="8:00pm">8:00pm</option>
                            <option value="8:30pm">8:30pm</option>
                            <option value="9:00pm">9:00pm</option>
                            <option value="9:30pm">9:30pm</option>
                            <option value="10:00pm">10:00pm</option>
                            <option value="10:30pm">10:30pm</option>
                            <option value="11:00pm">11:00pm</option>
                            <option value="11:30pm">11:30pm</option>
                            <option value="12:00pm">12:00pm</option>
                        </select>
                    </div>
                    <div class="form-message" id="form-message-time">Required</div>
                </div>


                <!--- Form error message --->
                <font class="form-message" id="form-message-1" style="color: #e06c6c"></font>

                <!--- Next button --->
                <button type="button" id="next-button-1" class="invalidButton" disabled>NEXT</button>
            </div>

            <!--- Second form card --->
            <div class="form-holder" id="form-holder-2" style="display: none">

                <!--- Description for new show --->
                <span class="show_label">Description</span>
                </br>
                <div style="display: flex; width: 100%;vertical-align: middle;align-items : center;">
                    <img style="height: 21px" class="form-icon" src="static/comment-icon.png" />
                    <textarea name="show_description" placeholder="Whats going on?"></textarea>
                </div>
                </br>

                <!--- New artist type --->
                <span class="show_label">Type of artist?</span>
                <br/>
                <div style="display: flex; width: 100%;vertical-align: middle;align-items : center;">
                    <img style="height: 21px" class="form-icon" src="static/user-icon.png" />
                    <select id ="show_artist" name="show_artist">
                        <option value="Any">Any</option>
                        <option value="Singer">Singer</option>
                        <option value="Band">Band</option>
                        <option value="Rapper">Rapper</option>
                        <option value="DJ">DJ</option>
                    </select>
                </div>

                <br/>

                <!--- New genres --->
                <span class="show_label">Genre</span>
                <br/>
                <div style="display: flex;flex-wrap: wrap; width: 100%;vertical-align: middle;align-items : center;">
                    <img style="height: 21px" class="form-icon" src="static/tag.png" />
                    <div class="show_genre_option ripple" value="Blues">Blues</div>
                    <div class="show_genre_option ripple" value="Rock">Rock</div>
                    <div class="show_genre_option ripple" value="Classical">Classical</div>
                    <div class="show_genre_option ripple" value="Hiphop">Hiphop</div>
                    <div class="show_genre_option ripple" value="Pop">Pop</div>
                    <div class="show_genre_option ripple" value="Jazz">Jazz</div>
                    <div class="show_genre_option ripple" value="Country">Country</div>
                    <div class="show_genre_option ripple" value="Funk">Funk</div>
                    <div class="show_genre_option ripple" value="Punk">Punk</div>
                    <div class="show_genre_option ripple" value="Reggae">Reggae</div>
                    <div class="show_genre_option ripple" value="Soul">Soul</div>
                    <div class="show_genre_option ripple" value="EDM">EDM</div>
                    <div class="show_genre_option ripple" value="Alternative">Alternative</div>
                    <div class="show_genre_option ripple" value="Instrumental">Instrumental</div>
                    <div class="show_genre_option ripple" value="Folk">Folk</div>
                    <div class="show_genre_option ripple" value="Dance">Dance</div>
                    <div class="show_genre_option ripple" value="Acoustic">Acoustic</div>
                    <div class="show_genre_option ripple" value="Bluegrass">Bluegrass</div>
                    <div class="show_genre_option ripple" value="Indie">Indie</div>
                    <div class="show_genre_option ripple" value="Metal">Metal</div>
                </div>

                <!--- Form error message --->
                <font class="form-message" id="form-message-2" style="color: #e06c6c"></font>

                <!--- Next button --->
                <button type="button" id="next-button-2" class="ripple" >NEXT</button>

                <!--- Prev button --->
                <button type="button" id="prev-button-1" class="prev-button" style="margin-right: 15px;">BACK</button>

            </div>

            <div class="form-holder" id="form-holder-3" style="display: none">
                <!--- New show price --->
                <span class="show_label">Budget</span>
                <br/>
                <div style="display: flex; width: 100%;vertical-align: middle;align-items : center;">
                    <img class="form-icon" src="static/dollar-sign.png" />
                    <input type="text" id="show_price" name="show_price" placeholder="500" autocomplete="off" required/>
                </div>
                <div class="form-message" id="form-message-price">Required</div>
                <br/>

                <!--- New show deposit --->
                <span class="show_label">Set length</span>
                <br/>
                <div style="display: flex; width: 100%;vertical-align: middle;align-items : center;">
                    <img class="form-icon" src="static/time.png" />
                    <select id="show_set_length">
                        <option>Pick a time</option>
                        <option>30min</option>
                        <option>1 hour</option>
                        <option>1.5 hours</option>
                        <option>2 hours</option>
                        <option>2.5 hours</option>
                        <option>3 hours</option>
                        <option>3.5 hours</option>
                        <option>4 hours</option>
                        <option>4.5 hours</option>
                        <option>5 hours</option>
                        <option>5.5 hours</option>
                        <option>6 hours</option>
                    </select>
                </div>
                <div class="form-message" id="form-message-set-time">Required</div>
                <br/>

                <!--- Requirements for new show --->
                <span class="show_label">Other Requirements</span>
                <br/>
                <div style="display: flex; width: 100%;vertical-align: middle;align-items : center;">
                    <img style="height: 21px" class="form-icon" src="static/padlock.png" />
                    <textarea id="show_requirements" name="show_requirements" placeholder="Bring equipment, max band size, show up 30 minutes early"></textarea>
                </div>
                <div class="form-message">Enter comma-separated values</div>
                <br/>

                <!--- Requirements for new show --->
                <span class="show_label">Artist Perks</span>
                <br/>
                <div style="display: flex; width: 100%;vertical-align: middle;align-items : center;">
                    <img style="height: 21px" class="form-icon" src="static/trophy.png" />
                    <textarea id="show_perks" name="show_perks" placeholder="% of ticket sales, free drinks/meal, etc"></textarea>
                </div>
                <div class="form-message">Enter comma-separated values</div>
                <br/>

                <div class="form-message" id="form-message-submit"></div>

                <!---Submit button --->
                <button type="button" id="list-show-button" class="invalidButton" disabled>LIST SHOW</button>

                <!--- Prev button --->
                <button type="button" id="prev-button-2" class="prev-button" style="margin-right: 15px;">BACK</button>
            </div>

        </div>

        <!--- If there is no account/payment method messages --->
        <div style="text-align: center;padding-bottom: 20px;">
            <div id="add_account_post_message" class='post_message'>Before you can post a show you must create a payment account.</div>
            <br/>
            <a href="/addpayments" id="add_account_link" class="add_payments_link ripple">Add a payment account</a>

            <div id="add_payment_post_message" class="post_message">Before you can post a show you must attach a payment method.</div>
            <br/>
            <a href="/payments" id="add_payment_link" class="add_payments_link ripple">Add a payment method</a>
        </div>

        <div style="text-align: center">
            <!--- Loading gif --->
            <img class="loading_gif" src="static/loading-spinner.gif" />
        </div>

    </div>
    <!--- End of Show posting card --->

    <!--- Black background for send messages screen --->
    <div id="blackbackground"></div>
    <!--- End of Black background --->

    <!--- Banner for messages --->
    <div id="message_banner" style="box-sizing: border-box;position: fixed;top: 0px;left: 0px;width: 100%;padding: 15px;font-size: 18px;text-align: center;color: #FFFFFF;display: none;"></div>

    <script type="text/javascript">

        //Attach loading gif to any ajax call
        $(document).ajaxStart(function() {
            $(".loading_gif").show();
        });

        $(document).ajaxStop(function() {
            $(".loading_gif").hide();
        });

        $("#listingbutton").click(function() {
            check_stripe_account()
            $("#postshow").show();
            $("#blackbackground").show()
        });

        $("#blackbackground").click(function() {
            $("#postshow").hide()
            $("#blackbackground").hide()
        })

        //Google autocomplete location search
        function load_google_location() {
            var input = document.getElementById('show_location');
            var autocomplete = new google.maps.places.Autocomplete(input);

            //Get place details
            autocomplete.addListener('place_changed', function () {
                // place variable will have all the information you are looking for.
                var place = autocomplete.getPlace();
            });
        }

        //Intialize google location search
        google.maps.event.addDomListener(window, 'load', load_google_location);

        //Check if venue has stripe account set up
        function check_stripe_account() {
            $.ajax({
                type: "POST",
                url: "/",
                data: {
                    "check_stripe_account": "check"
                },
                dataType: "json"
            }).done(function(data) {

                //If account has no payment method
                if (data['result'] == "No account") {
                    $("#add_account_post_message").show()
                    $("#add_account_link").show()
                }
                else if (data["result"] == "Has account") {

                    //Check if payment method attached
                    $.ajax({
                        type: "POST",
                        url: "/",
                        data: {
                            "check_stripe_payment_method": "check"
                        },
                        dataType: "json"
                    }).done(function(data) {

                        if (data['result'] == "has_payment") {
                            $("#new_show_container").show()
                        }
                        else {
                            $("#add_account_post_message").show()
                            $("#add_account_link").show()
                        }
                    });
                }
                else {
                    $("#post_message").show().html("There was an error loading your payment information").css("color", "red")
                }
            })
        }

        //Load show postings that are ending soon
        $.ajax({
            async: true,
            type: "POST",
            url: "/show_postings",
            data: {
                "get_user_postings_ending_soon": "check",
                "venue_id": "{% print uid %}"
            },
            dataType: "json"
        }).done(function(data) {

            if (data['success']) {
                let ending_shows = data['success']

                if (ending_shows.length == 0) {
                    $("#ending_shows").html("<div class='empty_box_text' style='font-size: 13px;padding: 10px;'>You do not have any shows ending soon</div>")
                }
                else {

                    //Loop through each result and format
                    for (i = 0; i < ending_shows.length; i++) {

                        let single_listing = `
                            <!--- Single Past listing --->
                            <div class="singlelisting">

                                <!--- Listing header --->
                                <div class="listing_header" style='text-align:left'>

                                    <!--- Listing details --->
                                    <div class="listing_details">

                                        <!--- Profile name --->
                                        <span class="listing_header_title" style='font-weight:bold;'>${ending_shows[i].business_name}</span>

                                        <!--- Location --->
                                        <div style="padding-top: 10px;">
                                            <!-- Icon --->
                                            <i class="material-icons" style="vertical-align: middle;font-size: 18px;color: #383838">place</i>

                                            <font class="detail_title">${ending_shows[i].location}</font>
                                        </div>

                                        <!--- Date --->
                                        <div style="overflow: hidden; padding-top: 10px;">
                                            <!-- Icon --->
                                            <i class="material-icons" style="vertical-align: middle;font-size: 18px;color: #383838">today</i>

                                            <font class="detail_title">
                                                ${ending_shows[i].show_date}
                                                <font style='font-size:11px'>@</font>
                                                ${ending_shows[i].show_time}
                                            </font>

                                        </div>

                                        <div style="margin: auto; margin-top: 7px; padding-top: 7px;overflow: hidden">
                                            <!--- Price --->
                                            <div style="float: left;overflow: hidden; padding-right: 25px;">
                                                <div style="padding-bottom: 5px;">Budget</div>

                                                <font style="font-weight: bold;font-size: 15px;color: #5f9341">$${ending_shows[i].price}</font>
                                            </div>

                                            <!--- Artist Type --->
                                            <div style="float: left;overflow: hidden; padding-right: 25px;">
                                                <div style="padding-bottom: 5px;">Artist</div>

                                                <font style="font-weight: bold;font-size: 15px;">${ending_shows[i].artist_type}</font>
                                            </div>

                                            <!--- Set length --->
                                            <div style="float: left;overflow: hidden;">
                                                <div style="padding-bottom: 5px;">Set length</div>

                                                <font style="font-weight: bold;font-size: 15px;">${ending_shows[i].set_length}</font>
                                            </div>
                                        </div>

                                    </div>

                                    <!--- More details link --->
                                    <a href="/shows?id=${ending_shows[i].show_id}" class="more_details_link">More details</a>

                                </div>

                            </div>
                            <!--- End of Single Past listing --->
                        `


                        $("#ending_shows").append(single_listing)
                    }
                }
            }
        });

        //Validate form group 1
        function validate_form_group1() {
            //Fields
            let show_location = $("#show_location")
            let show_date = $("#show_date")
            let show_time = $("#show_time")

            let form_list = [show_location,show_date,show_time]

            let result = true

            //Check if any empty
            for (x in form_list) {
                if (form_list[x].attr('id') == "show_time") {
                    let time_val = form_list[x].find(":selected").text()

                    if (time_val == "Select time") {
                        result = false
                    }
                }
                else {
                    if (form_list[x].val() == "") {
                        result = false
                    }
                }
            }

            if (result === true) {
                $("#next-button-1").prop('disabled', false).removeClass('invalidButton').addClass('ripple')
                $("#form-message-1").html("")
            }
            else {
                $("#next-button-1").prop('disabled', true).addClass('invalidButton').removeClass('ripple')
            }
        }

        //Validate form group 1
        function validate_one_input(this_input) {
            let input_val = this_input.val()
            let input_id = this_input.attr('id')

            //Location
            if (input_id == "show_location") {
                if (input_val == "") {
                    this_input.addClass("invalidForm")
                    $("#form-message-location").css("color", "#e06c6c")
                }
                else {
                    this_input.removeClass("invalidForm")
                    $("#form-message-location").css("color", "#d2d2d2")
                }
            }

            //Time
            if (input_id == 'show_time') {
                if (this_input.find(":selected").text() == "Select time") {
                    this_input.addClass("invalidForm")
                    $("#form-message-time").css("color", "#e06c6c")
                }
                else {
                    this_input.removeClass("invalidForm")
                    $("#form-message-time").css("color", "#d2d2d2")
                }
            }

            //Date
            if (input_id == "show_date") {
                if (input_val == "") {
                    this_input.addClass("invalidForm")
                    $("#form-message-date").css("color", "#e06c6c")
                }
                else {
                    this_input.removeClass("invalidForm")
                    $("#form-message-date").css("color", "#d2d2d2")
                }
            }

        }

        //Form on current input change validation
        $("#form-holder-1 input, #form-holder-1 select").on('change focusout', function() {
            let current_input = $(this)
            let input_id = $(this).attr('id')

            if (input_id == "show_date") {
                //Wait to give time for input to load in
                $.when(setTimeout(function() {
                    validate_one_input(current_input)
                }, 250)).then(function() {
                    //Check all fields
                    validate_form_group1()
                })
            }
            else {
                //Check current input then all
                $.when(validate_one_input(current_input)).then(function() {
                    //Check all fields
                    validate_form_group1()
                })
            }
        })

        //When next button 1 is pressed show next form window
        $("#next-button-1").click(function() {

            //Hide form holder 1
            $("#form-holder-1").hide();

            //Show form holder 2
            $("#form-holder-2").show();
        });

        //When next button 1 is pressed show next form window
        $("#prev-button-1").click(function() {

            //Hide form holder 2
            $("#form-holder-2").hide();

            //Show form holder 1
            $("#form-holder-1").show();
        });

        //active class to show_genre_option when clicked
        $(".show_genre_option").click(function() {
            $(this).toggleClass('show_genre_option_active')
        })

        //When next button 1 is pressed show next form window
        $("#next-button-2").click(function() {

            //Hide form holder 1
            $("#form-holder-2").hide();

            //Show form holder 2
            $("#form-holder-3").show();
        });

        //When next button 1 is pressed show next form window
        $("#prev-button-2").click(function() {

            //Hide form holder 3
            $("#form-holder-3").hide();

            //Show form holder 2
            $("#form-holder-2").show();
        });

        //Validate all form group 3 inputs
        function validate_form_group3() {
            let show_price = $("#show_price").val()
            let show_set_length = $("#show_set_length").find(":selected").text()
            let result = false

            //Check if any field is empty
            if (show_price == "" || show_set_length == "Pick a time") {
                result = false
            }
            //Check if show price is a number
            else if (isNaN(show_price)) {
                result = false
            }
            else if (Number(show_price) < 50) {
                result = false
            }
            else {
                result = true
            }

            //If form is valid let post
            if (result == true) {
                $("#list-show-button").prop('disabled', false).removeClass('invalidButton').addClass('ripple')
            }
            else {
                $("#list-show-button").prop('disabled', true).addClass('invalidButton').removeClass('ripple')
            }
        }

        //Check input form 3 that is being changed
        function validate_one_input3(current_input) {
            let input_id = current_input.attr('id')
            let input_val = current_input.val()

            //Check if field is required
            if (input_id == "show_price" || input_id == "show_set_length") {

                //If input is show price
                if (input_id == "show_price") {

                    //If empty
                    if (input_val == "") {
                        $("#form-message-price").html("Please fill out field").css("color", "#e06c6c")
                        $(current_input).addClass("invalidForm")
                    }
                    //If not a number
                    else if (isNaN(input_val)) {
                        $("#form-message-price").html("Must be a number").css("color", "#e06c6c")
                        $(current_input).addClass("invalidForm")
                    }
                    //If less than minimum required
                    else if (Number(input_val) < 50) {
                        $("#form-message-price").html("Minimum amount is $50").css("color", "#e06c6c")
                        $(current_input).addClass("invalidForm")
                    }
                    else {
                        $("#form-message-price").html("Required").css("color", "#d2d2d2")
                        $(current_input).removeClass("invalidForm")
                    }
                }

                //If input is show length
                if (input_id == "show_set_length") {

                    //If value is default
                    if (current_input.find(":selected").text() == "Pick a time") {
                        $("#form-message-set-time").html("Please select a time").css("color", "#e06c6c")
                        $(current_input).addClass("invalidForm")
                    }
                    else {
                        $("#form-message-set-time").html("Required").css("color", "#d2d2d2")
                        $(current_input).removeClass("invalidForm")
                    }
                }
            }
        }

        //On change check form group 3
        $("#form-holder-3 input, #form-holder-3 select").on('change focusout keyup', function(event) {
            let current_input = $(this)

            //Check single input and style
            validate_one_input3(current_input)

            //Check whole form and enable/disable button
            validate_form_group3()
        })

        //Gather all new show inputs and parse
        function new_show_parse_show_inputs() {

            //Input values
            let show_location = $("#show_location").val()
            let show_date = $("#show_date").val()
            let show_time = $("#show_time").find(":selected").text()
            let show_description = $("#show_description").val()
            let show_artist = $("#show_artist").find(":selected").text()
            let show_price = $("#show_price").val()
            let show_requirements = $("#show_requirements").val()
            let show_perks = $("#show_perks").val()
            let show_set_length = $("#show_set_length").find(":selected").text()

            //Arrays for multiple values
            let show_genres_list = []
            let show_requirements_list = []
            let show_perks_list = []

            //If description is empty
            if (show_description === undefined) {
                show_description = "No description"
            }

            //Loop through each show genre and get value
            $(".show_genre_option_active").each(function() {
                let single_genre = $(this).html()
                show_genres_list.push(single_genre);
            });

            //Parse requirements
            show_requirements = show_requirements.split(",")

            for (x in show_requirements) {
                //Check if not empty and trim whitespace
                if (/\S/.test(show_requirements[x])) {
                    show_requirements_list.push($.trim(show_requirements[x]))
                }
            }

            //Parse perks
            show_perks = show_perks.split(",")

            for (x in show_perks) {
                //Check if not empty and trim whitespace
                if (/\S/.test(show_perks[x])) {
                    show_perks_list.push($.trim(show_perks[x]))
                }
            }

            //Dictionary for all inputs
            return {
                'location': show_location,
                'date': show_date,
                'time': show_time,
                'description': show_description,
                'artist_type': show_artist,
                'genres': show_genres_list,
                'price': show_price,
                'requirements': show_requirements_list,
                'set_length': show_set_length,
                'perks': show_perks_list,
            }
        }

        //Validate required fields
        function new_show_fields_validate(required_fields) {
            let all_valid = true

            //Check if any field is empty
            for (x in required_fields) {

                //If empty mark group unvalid
                if (required_fields[x] == "") {
                    all_valid = false
                }
                else {
                    if (Number(required_fields.price) < 50) {
                        all_valid = false
                    }
                }
            }

            return all_valid
        }

        //Submit show posting
        $("#list-show-button").click(function() {

            //Disable submit button to prevent multiple posting
            $("#list-show-button").prop('disabled', true).addClass('invalidButton')

            //Get and parse all new show inputs
            let show_inputs = new_show_parse_show_inputs()

            //Required fields
            let required_fields = {
                'location': show_inputs.location,
                'date': show_inputs.date,
                'time': show_inputs.time,
                'price': show_inputs.price,
                'set_length': show_inputs.set_length
            }

            //Validate required inputs
            if (new_show_fields_validate(required_fields)) {

                //Send ajax call to post new message
                $.ajax({
                    type: "POST",
                    url: "/newshow",
                    data: {
                        'new_show': 'yes',
                        'show_inputs': JSON.stringify(show_inputs)
                    },
                    dataType: "json"
                }).done(function(data) {

                    if (data.success) {

                        //Clear all inputs
                        $('#new_show_container').find('input:text, textarea').val('');
                        $('#show_date').prop('selectedIndex',0);
                        $('#show_time').prop('selectedIndex',0);
                        $("#show_artist").prop('selectedIndex',0);
                        $('#show_set_length').prop('selectedIndex',0);
                        $('.show_genre_option').removeClass("show_genre_option_active")

                        //Reset form holders
                        $("#form-holder-1").show();
                        $("#form-holder-3").hide()

                        //Hide post show container and blackbackground
                        $("#postshow").hide()
                        $("#blackbackground").hide()

                        //Send banner message
                        let banner_message = `
                            <div class="banner-header">
                                <img src='static/success_checkmark.png' class='bannerIcon'>
                                <font style='font-size: 30px;font-weight: bold;vertical-align: middle'>Success!</font>
                            </div>
                            New show has been posted
                        `

                        //Flash success message
                        $("#message_banner").html(banner_message).css("background-color", "green").slideDown().delay(2000).slideUp()

                    }
                    else {
                        $("#form-message-submit").html(data.error).css("color", "#e06c6c")

                        //Enable submit button
                        $("#list-show-button").prop('disabled', false).removeClass('invalidButton')
                    }
                })
            }
            else {
                $("#form-message-submit").html("A required field is not filled out")
            }
        })

    </script>

  </body>
</html>
